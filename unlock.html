<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self'; 
    script-src 'self' 'unsafe-inline'; 
    style-src 'self' 'unsafe-inline';">
  <title>Unlock OPPCUS Token</title>
  <style>
    body { background:#000; color:#0F0; font-family:monospace; text-align:center; padding:50px; }
    button { background:#FFD140; color:#000; padding:10px 20px; font-weight:bold; border-radius:5px; cursor:pointer; }
    button:hover { background:#e6b800; }
  </style>
</head>
<body>
  <h1>ðŸ”“ OPPCUS Token</h1>
  <p>Processing your OPPCUS-token. Use if you lose access to content. Keep safe!</p>

<script>
const SALT = "oppcus-salt-v1";
const INDEX_URL = "https://hackerfrankone.github.io/oppc/index.html";

async function generateHash() {
  const data = navigator.userAgent + navigator.language + screen.width + screen.height + SALT;
  const encoder = new TextEncoder();
  const hashBuffer = await crypto.subtle.digest('SHA-256', encoder.encode(data));
  return Array.from(new Uint8Array(hashBuffer)).map(b => b.toString(16).padStart(2,'0')).join('');
}

(async () => {
  const hash = await generateHash();
  localStorage.setItem("oppcusTokenHash", hash);
  localStorage.setItem("unlocked", "paid");

  // Small delay to ensure localStorage write completes before redirect
  setTimeout(() => {
    window.location.href = INDEX_URL + "?unlocked=paid";
  }, 500);
})();
</script>
</body>
</html>
