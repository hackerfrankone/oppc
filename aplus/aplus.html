<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; img-src 'self'; frame-ancestors 'none';">
  <link rel="icon" type="image/png" href="/images/aplus.png">
  <title>CompTIA A+ PBQ - Tool Matching</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background-color: black;
      font-family: monospace;
      color: #00FF00;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 1rem;
      font-size: 1.2rem;
      font-weight: bold;
      position: relative;
    }

    .back-button {
      position: absolute;
      top: 10px;
      left: 10px;
      background-color: transparent;
      color: #00FF00;
      border: 2px solid #00FF00;
      padding: 6px 12px;
      font-size: 0.9rem;
      font-weight: bold;
      text-decoration: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s;
      user-select: none;
    }

    .back-button:hover {
      background-color: #00FF00;
      color: black;
    }

    .pbq-container {
      width: 90%;
      max-width: 700px;
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin: 0 auto;
    }

    .instructions {
      text-align: center;
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }

    .tools-container {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      min-height: 50px;
      background-color: #111;
      padding: 0.5rem;
      border: 2px solid #00FF00;
      border-radius: 5px;
      justify-content: center;
    }

    .tools-container.drag-over {
      border-color: #00cc00;
    }

    .tool {
      background-color: #0b0b0b;
      border: 2px solid #00FF00;
      padding: 0.5rem 1rem;
      border-radius: 5px;
      cursor: grab;
      user-select: none;
      font-size: 0.9rem;
      min-width: 80px;
      text-align: center;
    }

    .tool.dragging {
      opacity: 0.5;
      cursor: grabbing;
    }

    .tool.placed {
      background-color: #222;
      opacity: 0.8;
    }

    .description-box {
      background-color: #111;
      border: 2px solid #00FF00;
      padding: 0.5rem;
      border-radius: 5px;
      min-height: 50px;
      display: flex;
      align-items: center;
      font-size: 0.9rem;
      margin-bottom: 0.5rem;
      word-wrap: break-word;
    }

    .description-box.drag-over {
      border-color: #00cc00;
    }

    .description-box.filled {
      background-color: #222;
    }

    .buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-top: 1rem;
    }

    .clear-button, .submit-button {
      background-color: transparent;
      color: #00FF00;
      border: 2px solid #00FF00;
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
      font-family: monospace;
      cursor: pointer;
      border-radius: 5px;
    }

    .clear-button:hover, .submit-button:hover {
      background-color: #00FF00;
      color: black;
    }

    .clear-button:disabled, .submit-button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .feedback {
      margin-top: 1rem;
      text-align: center;
      font-size: 1rem;
      min-height: 1.5rem;
    }

    @media (max-width: 768px) {
      body {
        padding: 0.5rem;
      }

      .pbq-container {
        width: 95%;
      }

      .instructions {
        font-size: 1.2rem;
      }

      .tools-container {
        padding: 0.3rem;
        gap: 0.3rem;
      }

      .tool {
        font-size: 0.8rem;
        padding: 0.3rem 0.5rem;
        min-width: 60px;
      }

      .description-box {
        font-size: 0.8rem;
        padding: 0.3rem;
        min-height: 40px;
      }

      .clear-button, .submit-button {
        font-size: 0.8rem;
        padding: 0.3rem 0.7rem;
      }

      .feedback {
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <a href="../index.html" class="back-button">← Back</a>

  <div class="pbq-container">
    <div class="instructions">Drag each tool to its correct description</div>
    <div class="tools-container" id="tools"></div>
    <div class="description-box" data-answer="crimper">Used to attach connectors to the end of cables by pressing metal pins into the conductors.</div>
    <div class="description-box" data-answer="cable_stripper">Removes insulation from wires to expose conductors for connections.</div>
    <div class="description-box" data-answer="multimeter">Measures electrical properties like voltage, current, and resistance.</div>
    <div class="description-box" data-answer="punch_down_tool">Inserts wires into insulation-displacement connectors on patch panels or outlets.</div>
    <div class="description-box" data-answer="loopback_plug">Simulates network signals to test ports or network connectivity.</div>
    <div class="buttons">
      <button class="clear-button" id="clear">Clear</button>
      <button class="submit-button" id="submit" disabled>Submit</button>
    </div>
    <div class="feedback" id="feedback"></div>
  </div>

  <script>
    const toolsData = [
      { name: "Crimper", id: "crimper" },
      { name: "Cable Stripper", id: "cable_stripper" },
      { name: "Multimeter", id: "multimeter" },
      { name: "Punch Down Tool", id: "punch_down_tool" },
      { name: "Loopback Plug", id: "loopback_plug" }
    ];

    const toolsContainer = document.getElementById('tools');
    const submitButton = document.getElementById('submit');
    const clearButton = document.getElementById('clear');
    const feedback = document.getElementById('feedback');
    const descriptionBoxes = document.querySelectorAll('.description-box');

    // Shuffle tools array to randomize order
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    // Initialize tools
    function initializeTools() {
      toolsContainer.innerHTML = '';
      shuffle(toolsData);
      toolsData.forEach(tool => {
        const toolElement = document.createElement('div');
        toolElement.classList.add('tool');
        toolElement.setAttribute('draggable', true);
        toolElement.setAttribute('data-id', tool.id);
        toolElement.textContent = tool.name;
        toolsContainer.appendChild(toolElement);
      });
      updateToolStates();
      setupDragAndDrop();
    }

    // Update tool states (remove placed class from all tools not in description boxes)
    function updateToolStates() {
      const placedTools = document.querySelectorAll('.description-box .tool');
      document.querySelectorAll('.tool').forEach(tool => {
        const isPlaced = Array.from(placedTools).includes(tool);
        tool.classList.toggle('placed', isPlaced);
      });
      checkAllFilled();
    }

    // Drag and drop functionality
    function setupDragAndDrop() {
      // Tool drag events
      toolsContainer.addEventListener('dragstart', (e) => {
        if (e.target.classList.contains('tool')) {
          e.target.classList.add('dragging');
          e.dataTransfer.setData('text/plain', e.target.dataset.id);
        }
      });

      toolsContainer.addEventListener('dragend', (e) => {
        if (e.target.classList.contains('tool')) {
          e.target.classList.remove('dragging');
          updateToolStates();
        }
      });

      // Description box drop events
      descriptionBoxes.forEach(box => {
        box.addEventListener('dragover', (e) => {
          e.preventDefault();
          if (!box.querySelector('.tool')) {
            box.classList.add('drag-over');
          }
        });

        box.addEventListener('dragleave', () => {
          box.classList.remove('drag-over');
        });

        box.addEventListener('drop', (e) => {
          e.preventDefault();
          box.classList.remove('drag-over');
          if (!box.querySelector('.tool')) { // Only allow drop if box is empty
            const toolId = e.dataTransfer.getData('text/plain');
            const tool = document.querySelector(`.tool[data-id="${toolId}"]`);
            if (tool) {
              box.appendChild(tool);
              updateToolStates();
            }
          }
        });
      });

      // Tools container drop events
      toolsContainer.addEventListener('dragover', (e) => {
        e.preventDefault();
        toolsContainer.classList.add('drag-over');
      });

      toolsContainer.addEventListener('dragleave', () => {
        toolsContainer.classList.remove('drag-over');
      });

      toolsContainer.addEventListener('drop', (e) => {
        e.preventDefault();
        toolsContainer.classList.remove('drag-over');
        const toolId = e.dataTransfer.getData('text/plain');
        const tool = document.querySelector(`.tool[data-id="${toolId}"]`);
        if (tool) {
          tool.classList.remove('placed'); // Ensure the tool is re-highlighted
          toolsContainer.appendChild(tool);
          updateToolStates();
        }
      });
    }

    function checkAllFilled() {
      const allFilled = Array.from(descriptionBoxes).every(box => box.querySelector('.tool'));
      submitButton.disabled = !allFilled;
    }

    // Clear functionality
    clearButton.addEventListener('click', () => {
      console.log('Clearing all tools...');
      descriptionBoxes.forEach(box => {
        const tool = box.querySelector('.tool');
        if (tool) {
          toolsContainer.appendChild(tool);
          tool.classList.remove('placed'); // Explicitly remove placed class
          tool.style.backgroundColor = '#0b0b0b'; // Force re-highlight style
          tool.style.opacity = '1'; // Reset opacity
        }
      });
      updateToolStates(); // Sync all tool states
      feedback.textContent = '';
      submitButton.disabled = true;
    });

    function checkAnswers() {
      let correct = true;
      descriptionBoxes.forEach(box => {
        const tool = box.querySelector('.tool');
        if (tool && tool.dataset.id !== box.dataset.answer) {
          correct = false;
        }
      });
      feedback.textContent = correct ? '✅ All tools matched correctly!' : '❌ Some tools are incorrectly matched.';
      if (correct) {
        setTimeout(() => {
          feedback.textContent = '';
          descriptionBoxes.forEach(box => {
            const tool = box.querySelector('.tool');
            if (tool) {
              toolsContainer.appendChild(tool);
            }
          });
          initializeTools();
        }, 3000);
      }
    }

    submitButton.addEventListener('click', checkAnswers);

    // Initialize
    initializeTools();
  </script>
</body>
</html>
